(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3ab7846c"],{"10c2":function(e,t,r){},1962:function(e,t,r){"use strict";function s(e,t){var r=[{}];return r=t.filter(s(e)),r;function s(e){return function(t){return t.phone.indexOf(e)>=0||t.serial_num.indexOf(e)>=0||t.alias.toLowerCase().indexOf(e.toLowerCase())>=0||t.alias_spell.indexOf(e)>=0}}}r.d(t,"a",(function(){return s}))},"2f21":function(e,t,r){"use strict";var s=r("79e5");e.exports=function(e,t){return!!e&&s((function(){t?e.call(null,(function(){}),1):e.call(null)}))}},3121:function(e,t,r){},"321d":function(e,t,r){"use strict";var s=r("10c2"),n=r.n(s);n.a},"3a81":function(e,t,r){"use strict";var s=r("3121"),n=r.n(s);n.a},"504c":function(e,t,r){var s=r("0d58"),n=r("6821"),a=r("52a7").f;e.exports=function(e){return function(t){var r,i=n(t),o=s(i),c=o.length,m=0,_=[];while(c>m)a.call(i,r=o[m++])&&_.push(e?[r,i[r]]:i[r]);return _}}},"521c":function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[r("div",{staticClass:"func"},[r("div",{staticClass:"search"},[r("el-date-picker",{attrs:{type:"daterange","picker-options":e.pickerOptions,"range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",align:"right",size:"small","value-format":"yyyy-MM-dd HH:mm:ss",readonly:e.$permissionFn.readOnly()},model:{value:e.dateDuring,callback:function(t){e.dateDuring=t},expression:"dateDuring"}}),r("el-select",{attrs:{placeholder:"用户类型",size:"small",clearable:""},model:{value:e.userType,callback:function(t){e.userType=t},expression:"userType"}},e._l(e.userTypeList,(function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))),r("member-search",{attrs:{showText:!0},on:{selected:e.handleMemberSelect}}),r("el-select",{attrs:{placeholder:"订单类型",size:"small",clearable:""},model:{value:e.orderType,callback:function(t){e.orderType=t},expression:"orderType"}},e._l(e.orderTypeList,(function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))),r("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){e.getList("normal")}}},[e._v("搜索")])],1)]),r("div",{staticClass:"func"},[r("div",{staticClass:"search"},[r("el-input",{staticStyle:{"margin-right":"0"},attrs:{size:"small",placeholder:"起始单号",type:"number"},nativeOn:{mousewheel:function(e){e.preventDefault()}},model:{value:e.searchForm.start_order_no,callback:function(t){e.$set(e.searchForm,"start_order_no",t)},expression:"searchForm.start_order_no"}}),r("span",{staticStyle:{padding:"0 8px"}},[e._v("至")]),r("el-input",{attrs:{size:"small",placeholder:"结束单号",type:"number"},nativeOn:{mousewheel:function(e){e.preventDefault()}},model:{value:e.searchForm.end_order_no,callback:function(t){e.$set(e.searchForm,"end_order_no",t)},expression:"searchForm.end_order_no"}}),r("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){e.getList("orderNo")}}},[e._v("手工单号查询")])],1)]),Object.keys(e.orderStats).length?r("div",{staticClass:"orderStats"},[r("p",[e._v("\n      订单总数:\n      "),-1===e.searchForm.member_id?r("span",[e._v(e._s(e.orderStats.member.count))]):0===e.searchForm.member_id?r("span",[e._v(e._s(e.orderStats.tourist.count))]):r("span",[e._v(e._s(e.orderStats.report.count))]),e._v("\n      (消费订单：\n      "),-1===e.searchForm.member_id?r("span",[e._v(e._s(e.orderStats.member.count-e.orderStats.member.deposit_count-e.orderStats.member.new_count))]):0===e.searchForm.member_id?r("span",[e._v(e._s(e.orderStats.tourist.count))]):r("span",[e._v(e._s(e.orderStats.report.count-e.orderStats.member.deposit_count-e.orderStats.member.new_count))]),e._v("，\n      充值订单：\n      "),0===e.searchForm.member_id?r("span",[e._v("0")]):r("span",[e._v(e._s(e.orderStats.member.deposit_count))]),e._v("，\n      开卡订单：\n      "),0===e.searchForm.member_id?r("span",[e._v("0")]):r("span",[e._v(e._s(e.orderStats.member.new_count))]),e._v(")")]),r("p",[e._v("会员开卡:\n      "),0===e.searchForm.member_id?r("span",[e._v("0")]):r("span",[e._v(e._s(e.orderStats.member.new.prestore_price))]),e.orderStats.member.new_payments.length&&0!==e.searchForm.member_id?r("span",[e._v("\n        （"),e._l(e.orderStats.member.new_payments,(function(t,s){return r("span",{key:s},[e._v("\n          "+e._s(t.payment_name+" "+t.amount_price)+"\n          "),s<e.orderStats.member.new_payments.length-1?r("span",[e._v("，")]):e._e()])})),e._v("）\n      ")],2):e._e()]),r("p",[e._v("会员充值:\n      "),0===e.searchForm.member_id?r("span",[e._v("0")]):r("span",[e._v(e._s(e.orderStats.member.general.prestore_price))]),e.orderStats.member.deposit_payments.length&&0!==e.searchForm.member_id?r("span",[e._v("\n        （"),e._l(e.orderStats.member.deposit_payments,(function(t,s){return r("span",{key:s},[e._v("\n          "+e._s(t.payment_name+" "+t.amount_price)+"\n          "),s<e.orderStats.member.deposit_payments.length-1?r("span",[e._v("，")]):e._e()])})),e._v("）\n      ")],2):e._e()]),r("p",[e._v("消费订单:\n      "),-1===e.searchForm.member_id?r("span",[e._v("\n        "+e._s(e.orderStats.member.total-e.orderStats.member.general.giving_price-e.orderStats.member.general.prestore_price-e.orderStats.member.new.giving_price-e.orderStats.member.new.prestore_price))]):0===e.searchForm.member_id?r("span",[e._v(e._s(e.orderStats.tourist.total))]):r("span",[e._v(e._s(e.orderStats.report.consumePrice))]),e.orderStats.report.consume_payments.length&&""===e.searchForm.member_id?r("span",[e._v("\n        （"),e._l(e.orderStats.report.consume_payments,(function(t,s){return r("span",{key:s},[e._v("\n          "+e._s(t.payment_name+" "+t.amount_price)+"\n          "),s<e.orderStats.report.consume_payments.length-1?r("span",[e._v("，")]):e._e()])})),e._v("）\n      ")],2):e._e()]),r("p",[e._v("总体统计:现金总业绩:\n      "),-1===e.searchForm.member_id?r("span",[e._v(e._s(e.orderStats.member.total-e.orderStats.member.general.giving_price-e.orderStats.member.general.prestore_price-e.orderStats.member.new.giving_price-e.orderStats.member.new.prestore_price))]):0===e.searchForm.member_id?r("span",[e._v(e._s(e.orderStats.tourist.total))]):r("span",[e._v(e._s(e.orderStats.report.business))]),e._v("，\n      会员耗卡：\n      "),0===e.searchForm.member_id?r("span",[e._v("0")]):r("span",[e._v(e._s(e.orderStats.report.sys_pay.payment_balance||0+e.orderStats.report.sys_pay.giving_price||0))]),e._v("，\n      散客金额：\n      "),-1===e.searchForm.member_id?r("span",[e._v("0")]):(e.searchForm.member_id,r("span",[e._v(e._s(e.orderStats.tourist.total))]))]),""===e.searchForm.member_id?r("p",[e._v("支付方式:\n      "),e.orderStats.report.payments.length?r("span",e._l(e.orderStats.report.payments,(function(t,s){return r("span",{key:s},[e._v("\n          "+e._s(t.payment_name+" "+t.amount_price)+"\n          "),s<e.orderStats.report.payments.length-1?r("span",[e._v("，")]):e._e()])}))):r("span",[e._v("暂无信息")])]):e._e()]):e._e(),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticClass:"table-consume-custom",attrs:{data:e.list.slice((e.pageVar.page-1)*e.pageVar.pageSize,e.pageVar.page*e.pageVar.pageSize),"span-method":e.rowMerge,"cell-class-name":e.bonusCellClass,"header-cell-class-name":"el-table-header-cell-custom",fit:""}},[r("el-table-column",{attrs:{align:"center",label:"下单时间",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.orderDate)),r("br"),e._v(e._s(t.row.orderTime))]}}])}),r("el-table-column",{attrs:{align:"center",label:"单号","min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.order_no))]}}])}),r("el-table-column",{attrs:{align:"center",label:"会员资料",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("p",[e._v(e._s((t.row.alias||"散客")+"("+(t.row.gender?"男":"女")+"客:"+t.row.body_count+")"))]),r("p",[e._v(e._s(t.row.phone))]),r("p",[e._v("("+e._s(t.row.member_serial_num||"无卡号信息")+")")])]}}])}),r("el-table-column",{attrs:{align:"center",label:"付款明细","min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.payments,(function(t,s){return r("p",{key:s},[e._v("\n          "+e._s(t.payment_name+":"+t.amount_price)+"\n        ")])}))}}])}),r("el-table-column",{attrs:{align:"center",label:"合计","min-width":"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.paymentSum))]}}])}),r("el-table-column",{attrs:{align:"center",label:"项目明细","class-name":"bonus-column-custom"}},[r("el-table-column",{attrs:{align:"center",label:"消费项目"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("div",{staticClass:"bonus"},[t.row.shopping_cart.length?r("div",e._l(t.row.shopping_cart,(function(t,s){return r("div",{key:s,staticClass:"bonus-item"},[r("div",{staticClass:"name"},[e._v("\n                  "+e._s(t.good.alias)+"\n                  "),r("br"),e._v("\n                  (原价:"+e._s(t.good.sale_price)+")\n                  "),r("br"),["countBuyUse","countBoughtUse"].includes(t.type)?r("span",[r("br"),e._v(e._s("(使用"+t.useTimes+"次)")+"\n                  ")]):e._e()]),r("div",{staticClass:"perform"},[e._v("\n                  "+e._s(""+(["countBuyUse","countBoughtUse"].includes(t.type)?t.good.employ_cardinal_price*Number(t.useTimes):t.discountPriceAll))+"\n                ")]),r("div",{staticClass:"staffList"},e._l(t.bonusList,(function(t,s){return r("div",{key:s,staticClass:"staffList-item"},[r("div",{staticClass:"staffList-item-name"},[e._v(e._s(t.staff.staff_name))]),r("div",{staticClass:"staffList-item-isSpecial"},[e._v("\n                      "+e._s(t.specified_switch?"是":"否")+"\n                    ")]),r("div",{staticClass:"staffList-item-perform"},[e._v("\n                      "+e._s(t.performance_price)+"\n                    ")]),r("div",{staticClass:"staffList-item-commission"},[e._v("\n                      "+e._s(t.dividends_price)+"\n                    ")])])})))])}))):r("div",{staticClass:"bonus-item"},[r("div",{staticClass:"name"},[t.row.is_new_member?r("span",[e._v("\n                  开卡\n                ")]):(t.row.prestore_price||t.row.giving_price)&&t.row.integral>=0?r("span",[e._v("\n                  充值\n                ")]):!t.row.prestore_price&&!t.row.giving_price&&t.row.integral>0&&!t.row.gross_price?r("span",[e._v("\n                  积分充值"+e._s(t.row.integral)+"\n                ")]):t.row.integral<0&&!t.row.gross_price?r("span",[e._v("\n                  积分消费"+e._s(-t.row.integral)+"兑换"+e._s(t.row.prestore_price)+"元\n                ")]):r("span",[e._v("\n                  快速消费\n                ")]),(t.row.is_new_member||t.row.prestore_price||t.row.giving_price)&&t.row.giving_price>0?r("span",[r("br"),e._v("(赠金:"+e._s(t.row.giving_price)+")\n                ")]):e._e()]),r("div",{staticClass:"perform"},[r("span",[e._v("\n                  "+e._s(t.row.paymentSum)+"\n                ")])]),r("div",{staticClass:"staffList"},e._l(t.row.bonus,(function(t,s){return r("div",{key:s,staticClass:"staffList-item"},[r("div",{staticClass:"staffList-item-name"},[e._v(e._s(t.staff.staff_name))]),r("div",{staticClass:"staffList-item-isSpecial"},[e._v("\n                    "+e._s(t.specified_switch?"是":"否")+"\n                  ")]),r("div",{staticClass:"staffList-item-perform"},[e._v("\n                    "+e._s(t.performance_price)+"\n                  ")]),r("div",{staticClass:"staffList-item-commission"},[e._v("\n                    "+e._s(t.dividends_price)+"\n                  ")])])})))])])]}}])}),r("el-table-column",{attrs:{align:"center",label:"消费业绩"}}),r("el-table-column",{attrs:{align:"center",label:"员工信息"}}),r("el-table-column",{attrs:{align:"center",label:"是否指定"}}),r("el-table-column",{attrs:{align:"center",label:"员工业绩"}}),r("el-table-column",{attrs:{align:"center",label:"员工提成"}})],1),r("el-table-column",{attrs:{align:"center",label:"备注",width:"120","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.memo))]}}])}),r("el-table-column",{attrs:{label:"操作",align:"center",width:"145"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(r){e.handlePrint(t.row)}}},[e._v("打印")]),r("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(r){e.handleDel(t.row.id)}}},[e._v("撤单")])]}}])})],1),r("el-pagination",{attrs:{"current-page":e.pageVar.page,"page-sizes":e.pageVar.pageSizes,"page-size":e.pageVar.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.pageVar.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)},n=[],a=(r("20d6"),r("55dd"),r("7514"),r("8615"),r("ac6a"),r("5df3"),r("f400"),r("6762"),r("2fdb"),r("c5f6"),r("ed08")),i=r("badc"),o=r("fe63"),c={components:{MemberSearch:i["a"]},data:function(){return{dateDuring:"",userType:"",memberId:"",searchForm:{start_time:"",end_time:"",member_id:"",is_new_member:"",deposit_status:"",start_order_no:"",end_order_no:""},orderStats:{member:{general:{},new:{},payments:[],new_payments:[],deposit_payments:[]},tourist:{payments:[]},report:{sys_pay:{},consume_payments:[],payments:[]}},listLoading:!1,list:[],staffList:[],pickerOptions:{shortcuts:[{text:"昨天",onClick:function(e){var t=new Date(Object(a["i"])((new Date).getTime(),"{y}-{m}-{d}")+" 00:00:00"),r=new Date(Object(a["i"])((new Date).getTime(),"{y}-{m}-{d}")+" 23:59:59");t.setTime(t.getTime()-864e5),r.setTime(r.getTime()-864e5),e.$emit("pick",[t,r])}},{text:"最近一周",onClick:function(e){var t=new Date(Object(a["i"])((new Date).getTime(),"{y}-{m}-{d}")+" 00:00:00"),r=new Date(Object(a["i"])((new Date).getTime(),"{y}-{m}-{d}")+" 23:59:59");t.setTime(t.getTime()-6048e5),e.$emit("pick",[t,r])}},{text:"最近一个月",onClick:function(e){var t=new Date(Object(a["i"])((new Date).getTime(),"{y}-{m}-{d}")+" 00:00:00"),r=new Date(Object(a["i"])((new Date).getTime(),"{y}-{m}-{d}")+" 23:59:59");t.setTime(t.getTime()-2592e6),e.$emit("pick",[t,r])}}]},userTypeList:[{label:"全部",value:""},{label:"会员",value:-1},{label:"散客",value:0}],orderType:-1,orderTypeList:[{label:"全部",value:-1},{label:"消费订单",value:1},{label:"开卡订单",value:2},{label:"充值订单",value:3}],pageVar:{page:1,total:0,pageSize:50,pageSizes:[10,20,30,40,50]}}},watch:{dateDuring:function(){this.dateDuring&&this.dateDuring.length?(this.searchForm.start_time=Object(a["i"])(this.dateDuring[0],"{y}-{m}-{d}")+" 00:00:00",this.searchForm.end_time=Object(a["i"])(this.dateDuring[1],"{y}-{m}-{d}")+" 23:59:59"):(this.searchForm.start_time="",this.searchForm.end_time="")},orderType:function(e){switch(e){case 1:this.searchForm.is_new_member="",this.searchForm.deposit_status=0;break;case 2:this.searchForm.is_new_member=1,this.searchForm.deposit_status="";break;case 3:this.searchForm.is_new_member="",this.searchForm.deposit_status=1;break;default:this.searchForm.is_new_member="",this.searchForm.deposit_status="";break}}},created:function(){this.dateDuring=[Object(a["i"])(new Date,"{y}-{m}-{d}")+" 00:00:00",Object(a["i"])(new Date,"{y}-{m}-{d}")+" 23:59:59"],setTimeout(function(){this.getList()}.bind(this))},methods:{getList:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r={};if("orderNo"===t){if(Number(this.searchForm.end_order_no)<Number(this.searchForm.start_order_no))return void this.$Message.info("起始单号不能大于结束单号");if(this.searchForm.end_order_no-this.searchForm.start_order_no>500)return void this.$Message.info("单号范围不能超过500");var s=this.searchForm;r.start_order_no=s.start_order_no,r.end_order_no=s.end_order_no,this.orderStats={}}else{var n=new Date(this.searchForm.end_time).getTime()-new Date(this.searchForm.start_time).getTime();if(!isNaN(n)&&n>26784e5)return void this.$Message.info("日期范围不能大于1个月");this.searchForm.member_id=this.userType;var i=this.searchForm;r.start_time=i.start_time,r.end_time=i.end_time,r.userType=i.userType,r.member_id=i.member_id,r.is_new_member=i.is_new_member,r.deposit_status=i.deposit_status,this.memberId&&(r.member_id=this.memberId),r.member_id<=0&&[-1,""].includes(this.orderType)&&_.call(this),(r.member_id>0||this.orderType>=0)&&(this.orderStats={})}this.listLoading=!0;var o=new Map([["services","tenant_project"],["commodity","tenant_commodity"],["count","tenant_meter"],["countBuyUse","tenant_meter_employ"],["countBoughtUse","tenant_meter_employ"]]);function c(){var e=this;return this.$api.common.getStaffList().then((function(t){e.staffList=Object.values(t.data)}))}function m(){var e=this;return this.$api.business.getOrderList(r).then((function(t){if(!t.data.orders&&(t.data.orders=[]),e.list=t.data.orders.filter((function(t){return 1!==t.obsolete_status&&(t.paymentSum=t.payments?t.payments.reduce((function(e,t){return e+t.amount_price}),0):"",t.bonus||(t.bonus=[]),t.shopping_cart&&(t.shopping_cart=JSON.parse(t.shopping_cart),t.shopping_cart.map((function(e){!e.bonusList&&(e.bonusList=[]);var r=o.get(e.type);r&&t.bonus.map((function(t){t.type===r&&Number(e.index)===Number(t.source_weight)&&e.bonusList.push(t)}))}))),t.bonus.map((function(t){if(t.staff=e.staffList.find((function(e){return Number(e.id)===t.staff_id})),!t.staff)throw new Error("有一笔提成未匹配到员工",t)})),!0)})),t.data.orders.map((function(e){e.orderDate=Object(a["i"])(new Date(e.order_time),"{y}-{m}-{d}"),e.orderTime=Object(a["i"])(new Date(e.order_time),"{h}:{i}:{s}")})),e.listLoading=!1,e.pageVar.total=e.list.length,t.data.diff&&t.data.diff.length){t.data.diff.sort((function(e,t){return e-t}));var r=t.data.diff.reduce((function(e,t){return e?e+","+t:t}),"");e.$alert("不存在的单号:".concat(r),"提示",{confirmButtonText:"确定"})}}))}function _(){var e=this,t={start_time:r.start_time,end_time:r.end_time};return this.$api.business.getOrderStats(t).then((function(t){t.data.member.new_payments=t.data.member.new_payments||[],t.data.member.deposit_payments=t.data.member.deposit_payments||[],t.data.tourist.payments=t.data.tourist.payments||[],t.data.report.gender=t.data.report.gender||[],t.data.report.consume_payments=t.data.report.consume_payments||[],t.data.report.payments=t.data.report.payments||[];var s=JSON.parse(JSON.stringify(t.data.member.new_payments)),n=JSON.parse(JSON.stringify(t.data.member.deposit_payments));n.map((function(e){var t=s.find((function(t){return t.payment_name===e.payment_name}));t?t.amount_price+=e.amount_price:s.push(e)})),t.data.member.payments=s,t.data.report.consumePrice=t.data.report.consume_payments.reduce((function(e,t){return e+t.amount_price}),0),t.data.report.consumePrice=Number(t.data.report.consumePrice).toFixed(2),-1===r.member_id||r.member_id,e.orderStats=t.data}))}this.staffList.length?m.call(this):c.call(this).then((function(){m.call(e)}))},handleDel:function(e){var t=this;this.$confirm("是否确认撤单?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$api.business.delOrder(e).then((function(r){t.$message({type:"success",message:"撤单成功!"}),t.list.splice(t.list.findIndex((function(t){return t.id===e})),1)}))})).catch((function(){t.$message({type:"info",message:"已取消撤单"})}))},handlePrint:function(e){if(this.$store.state.print.setting.switch&&this.$store.state.print.isLodopLoad){var t;t=e.shopping_cart.length?["services","commodity"].includes(e.shopping_cart[0].type)?"good":"count":e.is_new_member?"card":(e.prestore_price||e.giving_price)&&e.integral>=0?"recharge":"consume";var r=this.$getLodop(document.getElementById("LODOP_OB"),document.getElementById("LODOP_EM")),s={type:t,orderTime:e.order_time,paymentList:e.payments||[],result:{payment:"",balance:""}};["card","recharge"].includes(s.type)?(s.recharge={deposit:e.prestore_price?Number(e.prestore_price):0,present:e.giving_price?Number(e.giving_price):0,actual:0},s.recharge.actual=Number(s.recharge.deposit)+Number(s.recharge.present),s.result.balance=e.member_balance_after_price):"consume"===s.type?s.consume={originalPayment:Number(e.gross_price)}:("good"===s.type||"count"===s.type)&&(s.goodList=e.shopping_cart),s.result.payment=e.payments?e.payments.reduce((function(e,t){return e+Number(t.amount_price)}),0):0,s.result.balance=e.member_balance_after_price?Number(e.member_balance_after_price):0,s.result.integral=e.member_integral_after?Number(e.member_integral_after):0;var n=new o["a"](r,{name:this.$store.getters.userInfo.store_name,phone:this.$store.getters.userInfo.trade,addr:this.$store.getters.userInfo.addr});n.createOrder({exist:Boolean(e.member_id),name:e.alias,cardNo:e.member_serial_num,phone:e.phone},s),n.setNum(Number(this.$store.state.print.setting.num)),n.print()}},handleMemberSelect:function(e){this.memberId=e.id},handleSizeChange:function(e){this.pageVar.pageSize=e,this.pageVar.page=1},handleCurrentChange:function(e){this.pageVar.page=e},rowMerge:function(e){e.row,e.column,e.rowIndex;var t=e.columnIndex;return 5===t?{colspan:6,rowspan:1}:t>5&&t<11?[0,0]:void 0},bonusCellClass:function(e){e.row,e.column,e.rowIndex;var t=e.columnIndex;if(5===t)return"bonus-column-custom"}}},m=c,_=(r("3a81"),r("719b"),r("2877")),l=Object(_["a"])(m,s,n,!1,null,"d3491194",null);l.options.__file="order.vue";t["default"]=l.exports},"55dd":function(e,t,r){"use strict";var s=r("5ca1"),n=r("d8e8"),a=r("4bf8"),i=r("79e5"),o=[].sort,c=[1,2,3];s(s.P+s.F*(i((function(){c.sort(void 0)}))||!i((function(){c.sort(null)}))||!r("2f21")(o)),"Array",{sort:function(e){return void 0===e?o.call(a(this)):o.call(a(this),n(e))}})},"6e14":function(e,t,r){},"719b":function(e,t,r){"use strict";var s=r("6e14"),n=r.n(s);n.a},8615:function(e,t,r){var s=r("5ca1"),n=r("504c")(!1);s(s.S,"Object",{values:function(e){return n(e)}})},badc:function(e,t,r){"use strict";var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-autocomplete",{attrs:{size:"medium","fetch-suggestions":e.querySearchAsync,placeholder:"请输入内容","popper-class":"search-suggestion","popper-append-to-body":!1,"highlight-first-item":""},on:{select:e.handleSelect},scopedSlots:e._u([{key:"default",fn:function(t){return[t.item.alias?r("div",{staticClass:"item"},[r("span",{staticClass:"ellipsis-1"},[e._v(e._s(t.item.alias))]),r("span",[e._v(e._s(t.item.phone||"暂无数据"))]),r("span",{staticClass:"ellipsis-1"},[e._v(e._s(t.item.serial_num||"暂无数据"))]),r("span",{staticClass:"ellipsis-1"},[e._v(e._s(t.item.balance_price))])]):r("div",{staticClass:"empty"},[e._v("\n      未搜索到相关数据\n    ")])]}}]),model:{value:e.searchText,callback:function(t){e.searchText=t},expression:"searchText"}},[r("template",{slot:"prepend"},[e._t("prepend")],2),r("template",{slot:"suffix"},[e._t("suffix")],2)],2)},n=[],a=(r("ac6a"),r("8615"),r("1962")),i={props:{showText:{type:Boolean,default:!1},memberList:{type:Array,default:function(){return[]}}},data:function(){return{loading:!1,curMemberList:[],searchText:"",searchPopHead:"",searchMemberListShow:!1,searchTimeout:0}},created:function(){this.memberList.length?this.loading=!0:this.getMemberList()},mounted:function(){var e=document.querySelector(".el-autocomplete-suggestion__list");this.searchPopHead=document.createElement("li"),this.searchPopHead.innerHTML='<div class="item">\n      <span>名称</span><span>手机号</span><span>卡号</span><span>余额</span>\n      </div>',e.appendChild(this.searchPopHead)},methods:{getMemberList:function(){var e=this;this.$api.common.getMemberList().then((function(t){e.curMemberList=t.data&&Object.values(t.data).filter((function(e){return 0===e.status})),e.loading=!0}))},querySearchAsync:function(e,t){var r=this;if(e)if(this.searchPopHead.style.display="none",this.loading){var s=this.memberList.length?this.memberList:this.curMemberList,n=e?Object(a["a"])(e,s):[];n.length||(n[0]={}),clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout((function(){r.searchPopHead.style.display="block",t(n)}),200)}else setTimeout((function(){r.querySearchAsync(e,t)}),200);else{var i=[];t(i)}},handleSelect:function(e){this.showText&&(this.searchText=e.alias),this.$emit("selected",e)}}},o=i,c=(r("321d"),r("2877")),m=Object(c["a"])(o,s,n,!1,null,"54be5a71",null);m.options.__file="memberSearch.vue";t["a"]=m.exports},f400:function(e,t,r){"use strict";var s=r("c26b"),n=r("b39a"),a="Map";e.exports=r("e0b8")(a,(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{get:function(e){var t=s.getEntry(n(this,a),e);return t&&t.v},set:function(e,t){return s.def(n(this,a),0===e?0:e,t)}},s,!0)},fe63:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));r("c5f6"),r("6762"),r("2fdb"),r("a481"),r("7f7f"),r("ac6a"),r("5df3"),r("f400"),r("cadf"),r("551c"),r("097d");var s=r("ed08");function n(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.LODOP=e,this.store={name:"",phone:"",addr:""},Object(s["d"])(this.store,t)}n.prototype.createOrder=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=15,a=580,i=18,o=65;this.member={exist:0,name:"",cardNo:"",phone:""};var c=new Map([["card",1],["recharge",2],["consume",3],["good",4],["count",5]]);this.order={type:1,orderTime:"",recharge:{deposit:"",present:"",actual:""},consume:{originalPayment:""},goodList:[],paymentList:[],result:{}},Object(s["d"])(this.member,t),Object(s["d"])(this.order,r),this.order.type=c.get(r.type),this.LODOP.SET_PRINT_PAGESIZE(3,a),this.LODOP.PRINT_INIT("订单信息"),n+=i,this.LODOP.SET_PRINT_STYLE("FontSize",12),this.LODOP.SET_PRINT_STYLE("Bold",1),this.LODOP.ADD_PRINT_TEXT(n,1,a,i,"店名:"),this.LODOP.ADD_PRINT_TEXT(n,o,a,i,this.store.name),n+=i,this.LODOP.SET_PRINT_STYLE("FontSize",10),this.LODOP.SET_PRINT_STYLE("Bold",1),this.LODOP.ADD_PRINT_TEXT(n,1,a,i,"联系电话:"),this.LODOP.ADD_PRINT_TEXT(n,o,a,i,this.store.phone),n+=i,this.LODOP.ADD_PRINT_TEXT(n,1,a,i,"地址:"),this.LODOP.ADD_PRINT_TEXT(n,35,a,i,this.store.addr),n+=i,this.LODOP.ADD_PRINT_TEXT(n,1,a,i,"******************************"),n+=i,this.LODOP.ADD_PRINT_TEXT(n,1,a,i,"日期:"),this.LODOP.ADD_PRINT_TEXT(n,o-25,a,i,this.order.orderTime),n+=i,this.member.exist?(this.LODOP.ADD_PRINT_TEXT(n,1,a,i,"会员姓名:"),this.LODOP.ADD_PRINT_TEXT(n,o,a,i,this.member.name),n+=i,this.LODOP.ADD_PRINT_TEXT(n,1,a,i,"卡号:"),this.LODOP.ADD_PRINT_TEXT(n,o,a,i,this.member.cardNo),n+=i,this.LODOP.ADD_PRINT_TEXT(n,1,a,i,"手机号:"),this.LODOP.ADD_PRINT_TEXT(n,o,a,i,this.member.phone&&this.member.phone.replace(/^(\d{3})\d{4}(\d{4})$/,"$1****$2")),n+=i):(this.LODOP.ADD_PRINT_TEXT(n,1,a,i,"散客"),n+=i),this.LODOP.ADD_PRINT_TEXT(n,1,a,i,"******************************"),n+=i,[1,2].includes(this.order.type)?(this.LODOP.ADD_PRINT_TEXT(n,1,a,i,"项目名称:"),this.LODOP.ADD_PRINT_TEXT(n,o,a,i,1===this.order.type?"会员开卡":"会员充值"),n+=i,this.LODOP.ADD_PRINT_TEXT(n,1,a,i,"充值金额:"),this.LODOP.ADD_PRINT_TEXT(n,o,a,i,Number(this.order.recharge.deposit).toFixed(2)),n+=i,this.LODOP.ADD_PRINT_TEXT(n,1,a,i,"赠送金额:"),this.LODOP.ADD_PRINT_TEXT(n,o,a,i,Number(this.order.recharge.present).toFixed(2)),n+=i,this.LODOP.ADD_PRINT_TEXT(n,1,a,i,"到账金额:"),this.LODOP.ADD_PRINT_TEXT(n,o,a,i,Number(this.order.recharge.actual).toFixed(2)),n+=i):3===this.order.type?(this.LODOP.ADD_PRINT_TEXT(n,1,a,i,"项目名称:"),this.LODOP.ADD_PRINT_TEXT(n,o,a,i,"快速消费"),n+=i,this.LODOP.ADD_PRINT_TEXT(n,1,a,i,"消费金额:"),this.LODOP.ADD_PRINT_TEXT(n,o,a,i,Number(this.order.consume.originalPayment).toFixed(2)),n+=i):4===this.order.type?this.order.goodList.map((function(t,r){e.LODOP.ADD_PRINT_TEXT(n,1,a,i,"项目名称:"),e.LODOP.ADD_PRINT_TEXT(n,o,a,i,t.good.alias),n+=i,e.LODOP.ADD_PRINT_TEXT(n,1,a,i,"数量:"),e.LODOP.ADD_PRINT_TEXT(n,o,a,i,Number(t.qty)),n+=i,e.LODOP.ADD_PRINT_TEXT(n,1,a,i,"价格:"),e.LODOP.ADD_PRINT_TEXT(n,o,a,i,Number(t.originalPriceAll).toFixed(2)),n+=i,e.LODOP.ADD_PRINT_TEXT(n,1,a,i,"折后价:"),e.LODOP.ADD_PRINT_TEXT(n,o,a,i,Number(t.discountPriceAll).toFixed(2)),n+=i,r<e.order.goodList.length-1&&(e.LODOP.ADD_PRINT_TEXT(n,1,a,i,".............................."),n+=i)})):5===this.order.type&&this.order.goodList.map((function(t,r){"count"===t.type?(e.LODOP.ADD_PRINT_TEXT(n,1,a,i,"计次名称:"),e.LODOP.ADD_PRINT_TEXT(n,o,a,i,t.good.alias),n+=i,e.LODOP.ADD_PRINT_TEXT(n,1,a,i,"次数:"),e.LODOP.ADD_PRINT_TEXT(n,o,a,i,t.isInfinite?"不限次数":Number(t.qty)),n+=i,e.LODOP.ADD_PRINT_TEXT(n,1,a,i,"价格:"),e.LODOP.ADD_PRINT_TEXT(n,o,a,i,Number(t.originalPriceAll).toFixed(2)),n+=i,e.LODOP.ADD_PRINT_TEXT(n,1,a,i,"折后价:"),e.LODOP.ADD_PRINT_TEXT(n,o,a,i,Number(t.discountPriceAll).toFixed(2)),n+=i):(e.LODOP.ADD_PRINT_TEXT(n,1,a,i,"计次名称:"),e.LODOP.ADD_PRINT_TEXT(n,o,a,i,t.good.alias),n+=i,e.LODOP.ADD_PRINT_TEXT(n,1,a,i,"使用次数:"),e.LODOP.ADD_PRINT_TEXT(n,o,a,i,Number(t.useTimes)),n+=i,e.LODOP.ADD_PRINT_TEXT(n,1,a,i,"剩余次数:"),e.LODOP.ADD_PRINT_TEXT(n,o,a,i,t.isInfinite?"不限次数":Number(t.surp)),n+=i),r<e.order.goodList.length-1&&(e.LODOP.ADD_PRINT_TEXT(n,1,a,i,".............................."),n+=i)})),this.LODOP.ADD_PRINT_TEXT(n,1,a,i,"******************************"),n+=i,[3,4,5].includes(this.order.type)&&(this.LODOP.ADD_PRINT_TEXT(n,1,a,i,"实付金额:"),this.LODOP.ADD_PRINT_TEXT(n,o,a,i,Number(this.order.result.payment).toFixed(2)),n+=i),this.member.exist&&(this.LODOP.ADD_PRINT_TEXT(n,1,a,i,"账户余额:"),this.LODOP.ADD_PRINT_TEXT(n,o,a,i,Number(this.order.result.balance).toFixed(2)),n+=i,this.LODOP.ADD_PRINT_TEXT(n,1,a,i,"积分余额:"),this.LODOP.ADD_PRINT_TEXT(n,o,a,i,Number(this.order.result.integral).toFixed(2)),n+=i),this.LODOP.ADD_PRINT_TEXT(n,1,a,i,"支付方式:"),this.order.paymentList.map((function(t){e.LODOP.ADD_PRINT_TEXT(n,o,a,i,t.payment_name),e.LODOP.ADD_PRINT_TEXT(n,2*o,a,i,Number(t.amount_price).toFixed(2)),n+=i})),this.order.paymentList.length||(n+=i),this.LODOP.ADD_PRINT_TEXT(n,1,a,i,"******************************"),n+=i,this.LODOP.ADD_PRINT_TEXT(n,25,a,i,"谢谢惠顾,欢迎下次光临!"),this.LODOP.SET_PRINT_PAGESIZE(3,a,45,"订单信息")},n.prototype.createReport=function(e){var t=this,r=15,n=580,a=18,i=140;this.LODOP.SET_PRINT_PAGESIZE(3,n),this.LODOP.PRINT_INIT("报表信息"),this.LODOP.SET_PRINT_STYLE("FontSize",13),this.LODOP.SET_PRINT_STYLE("Bold",1),this.LODOP.ADD_PRINT_TEXT(r,60,n,a,"今日报表"),r+=a,r+=a,this.LODOP.SET_PRINT_STYLE("FontSize",12),this.LODOP.SET_PRINT_STYLE("Bold",1),this.LODOP.ADD_PRINT_TEXT(r,1,n,a,"店名:"),this.LODOP.ADD_PRINT_TEXT(r,80,n,a,this.store.name),r+=a,this.LODOP.SET_PRINT_STYLE("FontSize",10),this.LODOP.SET_PRINT_STYLE("Bold",1),this.LODOP.ADD_PRINT_TEXT(r,1,n,a,"联系电话:"),this.LODOP.ADD_PRINT_TEXT(r,60,n,a,this.store.phone),r+=a,this.LODOP.ADD_PRINT_TEXT(r,1,n,a,"地址:"),this.LODOP.ADD_PRINT_TEXT(r,35,n,a,this.store.addr),r+=a,this.LODOP.ADD_PRINT_TEXT(r,1,n,a,"日期:"),this.LODOP.ADD_PRINT_TEXT(r,50,n,a,Object(s["i"])(new Date)),r+=a,this.LODOP.ADD_PRINT_TEXT(r,1,n,a,"******************************"),r+=a,this.LODOP.SET_PRINT_STYLE("FontSize",10),this.LODOP.SET_PRINT_STYLE("Bold",1),e.forEach((function(e,s){t.LODOP.ADD_PRINT_TEXT(r,1,n,a,"".concat(e.name,":")),t.LODOP.ADD_PRINT_TEXT(r,i,n,a,e.val),r+=a})),this.LODOP.SET_PRINT_PAGESIZE(3,n,45,"订单信息")},n.prototype.print=function(){this.LODOP.PRINT()},n.prototype.setNum=function(e){this.LODOP.SET_PRINT_COPIES(e)}}}]);