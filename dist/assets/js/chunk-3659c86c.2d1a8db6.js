(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3659c86c"],{"02a9":function(t,e,i){"use strict";var n=i("ca3d"),a=i.n(n);a.a},2178:function(t,e,i){},"30d9":function(t,e,i){},4974:function(t,e,i){"use strict";var n=i("2178"),a=i.n(n);a.a},"504c":function(t,e,i){var n=i("0d58"),a=i("6821"),s=i("52a7").f;t.exports=function(t){return function(e){var i,o=a(e),r=n(o),c=r.length,l=0,u=[];while(c>l)s.call(o,i=r[l++])&&u.push(t?[i,o[i]]:o[i]);return u}}},8615:function(t,e,i){var n=i("5ca1"),a=i("504c")(!1);n(n.S,"Object",{values:function(t){return a(t)}})},"86b0":function(t,e,i){"use strict";var n=i("e6ca"),a=i.n(n);a.a},b6a7:function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("Card",[i("div",[i("label",[t._v("员工状态：")]),i("Select",{staticStyle:{width:"200px"},model:{value:t.status,callback:function(e){t.status=e},expression:"status"}},t._l(t.statusList,(function(e){return i("Option",{key:e.value,attrs:{value:e.id}},[t._v(t._s(e.value)+"\n        ")])})))],1),i("router-link",{attrs:{to:"/staff/add_employee/0"}},[i("Button",{staticStyle:{margin:"10px"},attrs:{type:"primary"}},[t._v("添加员工")])],1),i("router-link",{attrs:{to:"/staff/depar_manager"}},[i("Button",{staticStyle:{margin:"10px"},attrs:{type:"primary"}},[t._v("部门管理")])],1),i("router-link",{attrs:{to:"/staff/position"}},[i("Button",{staticStyle:{margin:"10px"},attrs:{type:"primary"}},[t._v("主/职位管理")])],1),i("Poptip",{attrs:{placement:"bottom",width:"400"}},[i("Button",{staticStyle:{margin:"10px"},attrs:{type:"primary"}},[t._v("提成设置")]),i("div",{staticClass:"api",attrs:{slot:"content"},slot:"content"},[i("router-link",{attrs:{to:"/staff/rules/card"}},[i("div",[t._v("开卡")])]),i("router-link",{attrs:{to:"/staff/rules/recharge"}},[i("div",[t._v("充值")])]),i("router-link",{attrs:{to:"/staff/rules/speedy"}},[i("div",[t._v("快速消费")])]),i("router-link",{attrs:{to:"/staff/rules/services"}},[i("div",[t._v("服务项目")])]),i("router-link",{attrs:{to:"/staff/rules/commodities"}},[i("div",[t._v("商品设置")])]),i("router-link",{attrs:{to:"/staff/rules/count/buy"}},[i("div",[t._v("计次购买")])]),i("router-link",{attrs:{to:"/staff/rules/count/use"}},[i("div",[t._v("计次使用")])])],1)],1),i("router-link",{attrs:{to:"/staff/commission_list/0"}},[i("Button",{staticStyle:{margin:"10px"},attrs:{type:"primary"}},[t._v("提成列表")])],1),i("router-link",{attrs:{to:"/staff/performance_rules"}}),i("router-link",{attrs:{to:"/staff/survey"}},[i("Button",{staticStyle:{margin:"10px"},attrs:{type:"primary"}},[t._v("提成概况")])],1),i("Modal",{attrs:{title:"结算业绩","footer-hide":!0},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[i("Form",{ref:"formCustom",attrs:{"label-width":80},model:{value:t.formCustom,callback:function(e){t.formCustom=e},expression:"formCustom"}},[i("FormItem",{attrs:{label:"员工姓名"}},[i("Input",{attrs:{type:"text",disabled:"disabled"},model:{value:t.formCustom.name,callback:function(e){t.$set(t.formCustom,"name",e)},expression:"formCustom.name"}})],1),i("FormItem",{attrs:{label:"起始日期"}},[i("DatePicker",{staticStyle:{width:"100%"},attrs:{type:"date",value:t.formCustom.value1,placeholder:"请选择起始日期"}})],1),i("FormItem",{attrs:{label:"结束日期"}},[i("DatePicker",{staticStyle:{width:"100%"},attrs:{type:"date",value:t.formCustom.value2,placeholder:"请选择结束日期"}})],1),i("FormItem",[i("Button",{attrs:{type:"primary"},on:{click:function(e){t.handleSubmit("formCustom")}}},[t._v("结算")]),i("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(e){t.show=!1}}},[t._v("取消")])],1)],1)],1),i("tables",{ref:"tables",attrs:{editable:"",searchable:"","search-place":"top",columns:t.columns},model:{value:t.curStaffList,callback:function(e){t.curStaffList=e},expression:"curStaffList"}})],1),i("Modal",{attrs:{"footer-hide":!0,width:"1200px"},model:{value:t.staffCommissionShow,callback:function(e){t.staffCommissionShow=e},expression:"staffCommissionShow"}},[t.staffCommissionShow?i("StaffCommission",{attrs:{show:t.staffCommissionShow,staffId:t.curStaffId}}):t._e()],1)],1)},a=[],s=(i("456d"),i("7f7f"),i("ac6a"),i("8615"),i("fa69")),o=i("c24f"),r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"app-container"},[i("div",{staticClass:"func"},[i("div",{staticClass:"search"},[i("el-date-picker",{attrs:{type:"daterange","picker-options":t.pickerOptions,"range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",align:"right",size:"small","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:t.dateDuring,callback:function(e){t.dateDuring=e},expression:"dateDuring"}}),i("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){t.getList("normal")}}},[t._v("搜索")])],1)]),t.list.length?i("div",{staticClass:"list"},t._l(t.list,(function(e,n){return i("div",{key:n,staticClass:"item"},[t._v("\n          名称：【"+t._s(e.source_alias)+"】 提成：【"+t._s(e.dividends_price)+"】 业绩：【"+t._s(e.performance_price)+"】 数量：【"+t._s(e.count)+"】\n      ")])}))):i("div",[t._v("\n      暂无详情\n  ")])])},c=[],l=(i("c5f6"),i("cadf"),i("551c"),i("097d"),i("ed08")),u={props:{show:{type:Boolean,default:function(){return!1}},staffId:{type:Number,default:function(){return 0}}},data:function(){return{dateDuring:"",searchForm:{start_time:"",end_time:"",staff_id:""},listLoading:!1,list:[],pickerOptions:{shortcuts:[{text:"昨天",onClick:function(t){var e=new Date(Object(l["i"])((new Date).getTime(),"{y}-{m}-{d}")+" 00:00:00"),i=new Date(Object(l["i"])((new Date).getTime(),"{y}-{m}-{d}")+" 23:59:59");e.setTime(e.getTime()-864e5),i.setTime(i.getTime()-864e5),t.$emit("pick",[e,i])}},{text:"最近一周",onClick:function(t){var e=new Date(Object(l["i"])((new Date).getTime(),"{y}-{m}-{d}")+" 00:00:00"),i=new Date(Object(l["i"])((new Date).getTime(),"{y}-{m}-{d}")+" 23:59:59");e.setTime(e.getTime()-6048e5),t.$emit("pick",[e,i])}},{text:"最近一个月",onClick:function(t){var e=new Date(Object(l["i"])((new Date).getTime(),"{y}-{m}-{d}")+" 00:00:00"),i=new Date(Object(l["i"])((new Date).getTime(),"{y}-{m}-{d}")+" 23:59:59");e.setTime(e.getTime()-2592e6),t.$emit("pick",[e,i])}}]},pageVar:{page:1,total:0,pageSize:50,pageSizes:[10,20,30,40,50]}}},watch:{dateDuring:function(){this.dateDuring&&this.dateDuring.length?(this.searchForm.start_time=Object(l["i"])(this.dateDuring[0],"{y}-{m}-{d}")+" 00:00:00",this.searchForm.end_time=Object(l["i"])(this.dateDuring[1],"{y}-{m}-{d}")+" 23:59:59"):(this.searchForm.start_time="",this.searchForm.end_time="")},staffId:function(){this.staffId&&(this.searchForm.staff_id=this.staffId)},show:function(){this.getList()}},created:function(){this.staffId&&(this.searchForm.staff_id=this.staffId);var t=new Date(Object(l["i"])((new Date).getTime(),"{y}-{m}-{d}")+" 00:00:00"),e=new Date(Object(l["i"])((new Date).getTime(),"{y}-{m}-{d}")+" 23:59:59");this.dateDuring=[Object(l["i"])(t),Object(l["i"])(e)],setTimeout(function(){this.getList()}.bind(this))},methods:{getList:function(){var t=this;this.listLoading=!0,this.$api.staff.getBonus(this.searchForm).then((function(e){t.list=e.data[0].detail||[],t.listLoading=!1}))},handleSizeChange:function(t){this.pageVar.pageSize=t,this.pageVar.page=1},handleCurrentChange:function(t){this.pageVar.page=t}}},f=u,d=(i("02a9"),i("2877")),m=Object(d["a"])(f,r,c,!1,null,"2eab7acd",null);m.options.__file="staffCommission.vue";var p=m.exports,h={name:"staff",components:{Tables:s["a"],StaffCommission:p},data:function(){var t=this;return{staffCommissionShow:!1,curStaffId:0,positions:{},staffList:[],curStaffList:[],group:[],columns:[{title:"员工工号",key:"serial_num",align:"center",sortable:!0},{title:"员工姓名",key:"staff_name",align:"center"},{title:"登录账号",key:"account",align:"center",width:180},{title:"部门",key:"group_id",align:"center",render:function(e,i){var n=void 0===t.group.filter((function(t){return t.id===i.row.group_id}))[0]?"":t.group.filter((function(t){return t.id===i.row.group_id}))[0].alias;return e("slot",n)}},{title:"员工职位",key:"department",width:150,align:"center",render:function(e,i){var n=[],a=i.row.position;return Object.values(a).map((function(e){var i=t.positions[e.department_id]&&t.positions[e.department_id].alias+" ";e.position_id&&t.positions[e.department_id]&&(i+=t.positions[e.department_id].positions[e.position_id].alias),n.push(i)})),e("slot",n.join("\n"))}},{title:"操作",key:"action",width:450,align:"center",render:function(e,i){return 0===t.status?e("div",[e("Button",{props:{type:"info",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.edit(i.row.id)}}},"编辑"),e("Button",{props:{size:"small",type:"info"},style:{marginRight:"5px"},on:{click:function(){t.show=!0,t.formCustom.name=i.row.name,t.$router.push("/staff/commission_list/"+i.row.id)}}},"查看提成"),e("Button",{props:{size:"small",type:"info"},style:{marginRight:"5px"},on:{click:function(){t.curStaffId=i.row.id,t.staffCommissionShow=!0}}},"提成汇总"),e("Button",{props:{type:"error",size:"small"},on:{click:function(){t.disableStaff(i.row.id,i.index)}}},"封禁")]):1===t.status?e("div",[e("Button",{props:{type:"info",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.enableStaff(i.row,i.index)}}},"恢复")]):[]}}],statusList:[{id:0,value:"正常"},{id:1,value:"封禁"},{id:2,value:"全部"}],status:0,formCustom:[{name:"",value1:"",value2:""}],show:!1}},watch:{status:function(t){switch(t){case 0:this.curStaffList=this.staffList.filter((function(t){return 0===t.status}));break;case 1:this.curStaffList=this.staffList.filter((function(t){return 1===t.status}));break;case 2:this.curStaffList=this.staffList;break;default:break}}},mounted:function(){this.init()},methods:{init:function(){var t=this;this.$api.common.getPosition().then((function(e){Object.keys(e.data).map((function(t){0!==e.data[t].status&&delete e.data[t]})),t.positions=e.data})),this.$api.common.getGroup().then((function(e){t.group=e.data||[]})),this.$api.common.getStaffList().then((function(e){e.data&&(t.staffList=Object.values(e.data),t.curStaffList=t.staffList.filter((function(t){return 0===t.status})))}))},edit:function(t){var e={name:"add_employee",params:{id:t}};this.$router.push(e)},changeStatus:function(t,e){var i=this,n=this;t.login_status=e?0:1,t.position=Object.values(t.position),Object(o["update_staff"])(t).then((function(t){0===t.code&&(i.$Message.success("切换成功！"),n.init())}))},enableStaff:function(t,e){var i=this,n=JSON.parse(JSON.stringify(t)),a={};a.id=n.id,a.serial_num=n.serial_num,a.account=n.account,a.phone=n.phone,a.password=n.password,a.staff_name=n.staff_name,a.icon=n.icon,a.status=n.status,a.login_status=n.login_status,a.certificate=n.certificate,a.gender=n.gender,a.salary_num=n.salary_num,a.orders_permission=n.orders_permission,a.group_id=n.group_id,a.position=JSON.stringify(a.position),"[]"===a.orders_permission&&(a.orders_permission=""),a.status=0,this.$api.user.update_staff(a).then((function(t){i.$Message.success("恢复成功"),i.curStaffList.splice(e,1),i.$api.common.getStaffList().then((function(t){i.staffList=t.data?Object.values(t.data):[]}))}))},disableStaff:function(t,e){var i=this;this.$Modal.confirm({title:"信息",content:"是否确认封禁员工？",onOk:function(){Object(o["del_staff"])(t).then((function(t){i.curStaffList.splice(e,1),i.$Message.info("删除成功"),i.$api.common.getStaffList().then((function(t){i.staffList=t.data?Object.values(t.data):[]}))}))}})},handleSubmit:function(t){var e=this;this.$refs[t].validate((function(t){t?e.$Message.success("Success!"):e.$Message.error("Fail!")}))}}},g=h,v=(i("86b0"),Object(d["a"])(g,n,a,!1,null,"182fe9b2",null));v.options.__file="staff.vue";e["default"]=v.exports},ca3d:function(t,e,i){},e6ca:function(t,e,i){},fa69:function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("Table",{ref:"tablesMain",attrs:{data:t.insideTableData,columns:t.insideColumns,stripe:t.stripe,border:t.border,"show-header":t.showHeader,width:t.width,height:t.height,loading:t.loading,"disabled-hover":t.disabledHover,"highlight-row":t.highlightRow,"row-class-name":t.rowClassName,size:t.size,"no-data-text":t.noDataText,"no-filtered-data-text":t.noFilteredDataText},on:{"on-current-change":t.onCurrentChange,"on-select":t.onSelect,"on-select-cancel":t.onSelectCancel,"on-select-all":t.onSelectAll,"on-selection-change":t.onSelectionChange,"on-sort-change":t.onSortChange,"on-filter-change":t.onFilterChange,"on-row-click":t.onRowClick,"on-row-dblclick":t.onRowDblclick,"on-expand":t.onExpand}},[t._t("header",null,{slot:"header"}),t._t("footer",null,{slot:"footer"}),t._t("loading",null,{slot:"loading"})],2),t.searchable&&"bottom"===t.searchPlace?i("div",{staticClass:"search-con search-con-top"},[i("Input",{staticClass:"search-input",attrs:{placeholder:"输入关键字搜索"},model:{value:t.searchValue,callback:function(e){t.searchValue=e},expression:"searchValue"}}),i("Button",{staticClass:"search-btn",attrs:{type:"primary"}},[i("Icon",{attrs:{type:"search"}}),t._v("  搜索")],1)],1):t._e()],1)},a=[],s=(i("ac6a"),i("f751"),i("c5f6"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"tables-edit-outer"},[t.isEditting?i("div",{staticClass:"tables-editting-con"},[i("Input",{staticClass:"tables-edit-input",attrs:{value:t.value},on:{input:t.handleInput}}),i("Button",{staticStyle:{padding:"6px 4px"},attrs:{type:"text"},on:{click:t.saveEdit}},[i("Icon",{attrs:{type:"md-checkmark"}})],1),i("Button",{staticStyle:{padding:"6px 4px"},attrs:{type:"text"},on:{click:t.canceltEdit}},[i("Icon",{attrs:{type:"md-close"}})],1)],1):i("div",{staticClass:"tables-edit-con"},[i("span",{staticClass:"value-con"},[t._v(t._s(t.value))]),t.editable?i("Button",{staticClass:"tables-edit-btn",staticStyle:{padding:"2px 4px"},attrs:{type:"text"},on:{click:t.startEdit}},[i("Icon",{attrs:{type:"md-create"}})],1):t._e()],1)])}),o=[],r={name:"TablesEdit",props:{value:[String,Number],edittingCellId:String,params:Object,editable:Boolean},computed:{isEditting:function(){return this.edittingCellId==="editting-".concat(this.params.index,"-").concat(this.params.column.key)}},methods:{handleInput:function(t){this.$emit("input",t)},startEdit:function(){this.$emit("on-start-edit",this.params)},saveEdit:function(){this.$emit("on-save-edit",this.params)},canceltEdit:function(){this.$emit("on-cancel-edit",this.params)}}},c=r,l=(i("4974"),i("2877")),u=Object(l["a"])(c,s,o,!1,null,null,null);u.options.__file="edit.vue";var f=u.exports,d={delete:function(t,e,i){return t("Poptip",{props:{confirm:!0,title:"你确定要删除吗?"},on:{"on-ok":function(){i.$emit("on-delete",e),i.$emit("input",e.tableData.filter((function(t,i){return i!==e.row.initRowIndex})))}}},[t("Button",{props:{type:"text",ghost:!0}},[t("Icon",{props:{type:"md-trash",size:18,color:"#000000"}})])])}},m=d,p=(i("30d9"),{name:"Tables",props:{value:{type:Array,default:function(){return[]}},columns:{type:Array,default:function(){return[]}},size:String,width:{type:[Number,String]},height:{type:[Number,String]},stripe:{type:Boolean,default:!1},border:{type:Boolean,default:!1},showHeader:{type:Boolean,default:!0},highlightRow:{type:Boolean,default:!1},rowClassName:{type:Function,default:function(){return""}},context:{type:Object},noDataText:{type:String},noFilteredDataText:{type:String},disabledHover:{type:Boolean},loading:{type:Boolean,default:!1},editable:{type:Boolean,default:!1},searchable:{type:Boolean,default:!1},searchPlace:{type:String,default:"top"}},data:function(){return{insideColumns:[],insideTableData:[],edittingCellId:"",edittingText:"",searchKey:""}},methods:{suportEdit:function(t,e){var i=this;return t.render=function(t,e){return t(f,{props:{params:e,value:i.insideTableData[e.index][e.column.key],edittingCellId:i.edittingCellId,editable:i.editable},on:{input:function(t){i.edittingText=t},"on-start-edit":function(t){i.edittingCellId="editting-".concat(t.index,"-").concat(t.column.key),i.$emit("on-start-edit",t)},"on-cancel-edit":function(t){i.edittingCellId="",i.$emit("on-cancel-edit",t)},"on-save-edit":function(t){i.value[t.row.initRowIndex][t.column.key]=i.edittingText,i.$emit("input",i.value),i.$emit("on-save-edit",Object.assign(t,{value:i.edittingText})),i.edittingCellId=""}}})},t},surportHandle:function(t){var e=this,i=t.options||[],n=[];i.forEach((function(t){m[t]&&n.push(m[t])}));var a=t.button?[].concat(n,t.button):n;return t.render=function(t,i){return i.tableData=e.value,t("div",a.map((function(n){return n(t,i,e)})))},t},handleColumns:function(t){var e=this;this.insideColumns=t.map((function(t,i){var n=t;return n.editable&&(n=e.suportEdit(n,i)),"handle"===n.key&&(n=e.surportHandle(n)),n}))},setDefaultSearchKey:function(){this.searchKey="handle"!==this.columns[0].key?this.columns[0].key:this.columns.length>1?this.columns[1].key:""},handleTableData:function(){this.insideTableData=this.value.map((function(t,e){var i=t;return i.initRowIndex=e,i}))},exportCsv:function(t){this.$refs.tablesMain.exportCsv(t)},clearCurrentRow:function(){this.$refs.talbesMain.clearCurrentRow()},onCurrentChange:function(t,e){this.$emit("on-current-change",t,e)},onSelect:function(t,e){this.$emit("on-select",t,e)},onSelectCancel:function(t,e){this.$emit("on-select-cancel",t,e)},onSelectAll:function(t){this.$emit("on-select-all",t)},onSelectionChange:function(t){this.$emit("on-selection-change",t)},onSortChange:function(t,e,i){this.$emit("on-sort-change",t,e,i)},onFilterChange:function(t){this.$emit("on-filter-change",t)},onRowClick:function(t,e){this.$emit("on-row-click",t,e)},onRowDblclick:function(t,e){this.$emit("on-row-dblclick",t,e)},onExpand:function(t,e){this.$emit("on-expand",t,e)},show:function(t,e){this.$emit("show",t,e)},remove:function(t,e){this.$emit("remove",t,e)}},watch:{columns:function(t){this.handleColumns(t),this.setDefaultSearchKey()},value:function(t){this.handleTableData()}},mounted:function(){this.handleColumns(this.columns),this.setDefaultSearchKey(),this.handleTableData()}}),h=p,g=Object(l["a"])(h,n,a,!1,null,null,null);g.options.__file="tables.vue";var v=g.exports;e["a"]=v}}]);