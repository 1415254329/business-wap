(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-66bb7b80"],{"5c17":function(e,o,t){"use strict";var r=t("e651"),s=t.n(r);s.a},b427:function(e,o,t){"use strict";var r=t("bfa6"),s=t.n(r);s.a},bfa6:function(e,o,t){},e49c:function(e,o,t){"use strict";t.r(o);var r=function(){var e=this,o=e.$createElement,t=e._self._c||o;return t("div",{staticClass:"login"},[t("h2",{staticClass:"title"},[e._v("玄鸟Haswallow")]),t("div",{staticClass:"login-con"},[t("div",{staticClass:"login-container"},[t("div",{staticClass:"login-container-header"},[e._v("商管家")]),t("login-form",{staticClass:"login-container-content",on:{"on-success-valid":e.handleSubmit,register:e.reg}})],1)])])},s=[],n=(t("f751"),t("be94")),a=function(){var e=this,o=e.$createElement,t=e._self._c||o;return 1===e.regs?t("div",[t("Form",{ref:"loginForm",attrs:{model:e.form,rules:e.rules},nativeOn:{keydown:function(o){return!("button"in o)&&e._k(o.keyCode,"enter",13,o.key,"Enter")?null:e.handleSubmit(o)}}},[t("FormItem",{attrs:{prop:"account"}},[t("Input",{attrs:{placeholder:"请输入账号"},model:{value:e.form.account,callback:function(o){e.$set(e.form,"account",o)},expression:"form.account"}},[t("span",{attrs:{slot:"prepend"},slot:"prepend"},[t("Icon",{attrs:{size:16,type:"ios-person"}})],1)])],1),t("FormItem",{attrs:{prop:"password"}},[t("Input",{attrs:{type:"password",placeholder:"请输入密码"},model:{value:e.form.password,callback:function(o){e.$set(e.form,"password",o)},expression:"form.password"}},[t("span",{attrs:{slot:"prepend"},slot:"prepend"},[t("Icon",{attrs:{size:14,type:"md-lock"}})],1)])],1),t("FormItem",[t("Button",{attrs:{type:"primary",long:""},on:{click:e.handleSubmit}},[e._v("登录")])],1),t("FormItem",[t("div",{staticClass:"footer"},[t("el-radio-group",{staticClass:"choostType",model:{value:e.loginType,callback:function(o){e.loginType=o},expression:"loginType"}},[t("el-radio",{attrs:{label:1}},[e._v("商户")]),e.$store.getters.userInfo?t("el-radio",{attrs:{label:2}},[e._v("员工")]):e._e()],1),t("span",{staticClass:"login-tip",on:{click:function(o){e.forgotShow=!0}}},[e._v("找回密码")]),t("span",{staticClass:"login-tip",on:{click:function(o){e.reg(2)}}},[e._v("立即注册")])],1)])],1),t("Modal",{attrs:{className:"forgotForm",width:"450"},model:{value:e.forgotShow,callback:function(o){e.forgotShow=o},expression:"forgotShow"}},[t("Form",{ref:"forgotForm",attrs:{model:e.forgotForm},nativeOn:{keydown:function(o){return!("button"in o)&&e._k(o.keyCode,"enter",13,o.key,"Enter")?null:e.handleForgot(o)}}},[t("FormItem",{attrs:{prop:"account"}},[t("Input",{attrs:{placeholder:"请输入手机号"},model:{value:e.forgotForm.account,callback:function(o){e.$set(e.forgotForm,"account",o)},expression:"forgotForm.account"}})],1),t("FormItem",[t("Button",{attrs:{type:"primary",long:""},on:{click:e.handleForgot}},[e._v("确认")])],1)],1),t("div",{attrs:{slot:"footer"},slot:"footer"})],1)],1):t("div",[t("Form",{ref:"reg_form",attrs:{model:e.reg_form,rules:e.rules},nativeOn:{keydown:function(o){return!("button"in o)&&e._k(o.keyCode,"enter",13,o.key,"Enter")?null:e.handleSubmit(o)}}},[t("FormItem",{attrs:{prop:"account"}},[t("Input",{attrs:{placeholder:"请输入账号"},model:{value:e.reg_form.account,callback:function(o){e.$set(e.reg_form,"account",o)},expression:"reg_form.account"}},[t("span",{attrs:{slot:"prepend"},slot:"prepend"},[t("Icon",{attrs:{size:16,type:"ios-person"}})],1)])],1),t("FormItem",{attrs:{prop:"phone"}},[t("Input",{attrs:{placeholder:"请输入手机号",maxlength:11,type:"number"},model:{value:e.reg_form.phone,callback:function(o){e.$set(e.reg_form,"phone",o)},expression:"reg_form.phone"}},[t("span",{attrs:{slot:"prepend"},slot:"prepend"},[t("Icon",{attrs:{size:16,type:"ios-person"}})],1)])],1),t("FormItem",{attrs:{prop:"store_name"}},[t("Input",{attrs:{placeholder:"请输入商户名"},model:{value:e.reg_form.store_name,callback:function(o){e.$set(e.reg_form,"store_name",o)},expression:"reg_form.store_name"}},[t("span",{attrs:{slot:"prepend"},slot:"prepend"},[t("Icon",{attrs:{size:16,type:"ios-person"}})],1)])],1),t("FormItem",{attrs:{prop:"password"}},[t("Input",{attrs:{type:"password",placeholder:"请输入密码"},model:{value:e.reg_form.password,callback:function(o){e.$set(e.reg_form,"password",o)},expression:"reg_form.password"}},[t("span",{attrs:{slot:"prepend"},slot:"prepend"},[t("Icon",{attrs:{size:14,type:"md-lock"}})],1)])],1),t("FormItem",{attrs:{prop:"password2"}},[t("Input",{attrs:{type:"password",placeholder:"请再次确认密码"},model:{value:e.reg_form.password2,callback:function(o){e.$set(e.reg_form,"password2",o)},expression:"reg_form.password2"}},[t("span",{attrs:{slot:"prepend"},slot:"prepend"},[t("Icon",{attrs:{size:14,type:"md-lock"}})],1)])],1),t("FormItem",[t("Button",{attrs:{type:"primary",long:""},on:{click:e.register}},[e._v("注册")])],1),t("span",{staticClass:"login-tip",on:{click:function(o){e.reg(1)}}},[e._v("立即登录")])],1)],1)},i=[],c={name:"LoginForm",props:{passwordRules:{type:Array,default:function(){}},passwordRules2:{type:Array,default:function(){return[]}},shopName:{type:Array,default:function(){return[]}},account:{type:Array,default:function(){return[]}},phoneRules:{type:Array,default:function(){return[{required:!0,message:"手机号不能为空",trigger:"blur"},{pattern:/^1[3456789]\d{9}$/,message:"手机号码格式不正确",trigger:"blur",max:11}]}}},data:function(){return{loginType:1,form:{account:"",password:""},reg_form:{phone:"",store_name:"",password:"",password2:"",account:""},forgotForm:{account:""},forgotShow:!1,regs:1}},computed:{rules:function(){return{phone:this.phoneRules,store_name:this.store_name,password:this.passwordRules,password2:this.passwordRules2,account:this.account}}},methods:{handleSubmit:function(){var e=this;this.$refs.loginForm.validate((function(o){o?e.$emit("on-success-valid",{account:e.form.account,password:e.form.password,loginType:e.loginType}):e.$Message.info("请填写完整")}))},register:function(){var e=this;this.$refs.reg_form.validate((function(o){o?e.reg_form.password!=e.reg_form.password2?e.$Message.info("两次密码不一致！"):e.$emit("register",{phone:e.reg_form.phone,password:e.reg_form.password,store_name:e.reg_form.store_name,account:e.reg_form.account}):e.$Message.info("请填写完整")}))},handleForgot:function(){var e=this;this.$api.user.forgotPWD(this.forgotForm).then((function(o){e.forgotShow=!1,e.$Message.success("提交成功")}))},reg:function(e){1===e?this.$refs.reg_form.resetFields():2===e&&this.$refs.loginForm.resetFields(),this.regs=e}}},l=c,p=(t("b427"),t("2877")),u=Object(p["a"])(l,a,i,!1,null,"6bdf2ba6",null);u.options.__file="login-form.vue";var m=u.exports,f=m,d=t("2f62"),g={components:{LoginForm:f},methods:Object(n["a"])({},Object(d["b"])("user",["handleLogin"]),{handleSubmit:function(e){var o=this,t=e.account,r=e.password,s=e.loginType,n={account:t,password:r};if(this.$store.commit("user/setPassword",r),1===s)this.handleLogin(Object.assign({},n,{type:"store"})).then((function(e){o.$Message.info("登录成功！"),o.$router.push({name:o.$config.homeName})}));else if(2===s){if(this.$store.getters.userInfo){var a=this.$store.getters.userInfo;n["tenant_id"]=a.id,n["master_id"]=a.master_id}this.handleLogin(Object.assign({},n,{type:"staff"})).then((function(e){o.$Message.info("登录成功！"),o.$router.push({name:o.$config.homeName})}))}},reg:function(e){var o=this,t=e.account,r=e.phone,s=e.password,n=e.store_name;this.$api.user.register({account:t,phone:r,password:s,store_name:n}).then((function(e){0===e.code?o.$Modal.info({content:"注册成功！请前往登录",onOk:function(){location.href=""}}):o.$Message.info(e.message)}))}})},h=g,_=(t("5c17"),Object(p["a"])(h,r,s,!1,null,"3c603017",null));_.options.__file="login.vue";o["default"]=_.exports},e651:function(e,o,t){}}]);